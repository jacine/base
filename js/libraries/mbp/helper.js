/**
 * MBP - Mobile boilerplate helper functions
 */
(function(a){function b(a,b,c,d){if("addEventListener"in a)try{a.addEventListener(b,c,d)}catch(e){if("object"!=typeof c||!c.handleEvent)throw e;a.addEventListener(b,function(a){c.handleEvent.call(c,a)},d)}else"attachEvent"in a&&("object"==typeof c&&c.handleEvent?a.attachEvent("on"+b,function(){c.handleEvent.call(c)}):a.attachEvent("on"+b,c))}function c(a,b,c,d){if("removeEventListener"in a)try{a.removeEventListener(b,c,d)}catch(e){if("object"!=typeof c||!c.handleEvent)throw e;a.removeEventListener(b,function(a){c.handleEvent.call(c,a)},d)}else"detachEvent"in a&&("object"==typeof c&&c.handleEvent?a.detachEvent("on"+b,function(){c.handleEvent.call(c)}):a.detachEvent("on"+b,c))}window.MBP=window.MBP||{},MBP.viewportmeta=a.querySelector&&a.querySelector('meta[name="viewport"]'),MBP.ua=navigator.userAgent,MBP.scaleFix=function(){MBP.viewportmeta&&/iPhone|iPad|iPod/.test(MBP.ua)&&!/Opera Mini/.test(MBP.ua)&&(MBP.viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0",a.addEventListener("gesturestart",MBP.gestureStart,!1))},MBP.gestureStart=function(){MBP.viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"},MBP.BODY_SCROLL_TOP=!1,MBP.getScrollTop=function(){var b=window,c=a;return b.pageYOffset||"CSS1Compat"===c.compatMode&&c.documentElement.scrollTop||c.body.scrollTop||0},MBP.hideUrlBar=function(){var a=window;location.hash||MBP.BODY_SCROLL_TOP===!1||a.scrollTo(0,1===MBP.BODY_SCROLL_TOP?0:1)},MBP.hideUrlBarOnLoad=function(){var c,a=window,b=a.document;!location.hash&&a.addEventListener&&(window.scrollTo(0,1),MBP.BODY_SCROLL_TOP=1,c=setInterval(function(){b.body&&(clearInterval(c),MBP.BODY_SCROLL_TOP=MBP.getScrollTop(),MBP.hideUrlBar())},15),a.addEventListener("load",function(){setTimeout(function(){20>MBP.getScrollTop()&&MBP.hideUrlBar()},0)}))},MBP.fastButton=function(a,b,c){if(this.handler=b,this.pressedClass=c===void 0?"pressed":c,a.length&&a.length>1)for(var d in a)this.addClickEvent(a[d]);else this.addClickEvent(a)},MBP.fastButton.prototype.handleEvent=function(a){switch(a=a||window.event,a.type){case"touchstart":this.onTouchStart(a);break;case"touchmove":this.onTouchMove(a);break;case"touchend":this.onClick(a);break;case"click":this.onClick(a)}},MBP.fastButton.prototype.onTouchStart=function(b){var c=b.target||b.srcElement;b.stopPropagation(),c.addEventListener("touchend",this,!1),a.body.addEventListener("touchmove",this,!1),this.startX=b.touches[0].clientX,this.startY=b.touches[0].clientY,c.className+=" "+this.pressedClass},MBP.fastButton.prototype.onTouchMove=function(a){(Math.abs(a.touches[0].clientX-this.startX)>10||Math.abs(a.touches[0].clientY-this.startY)>10)&&this.reset(a)},MBP.fastButton.prototype.onClick=function(a){a=a||window.event;var b=a.target||a.srcElement;a.stopPropagation&&a.stopPropagation(),this.reset(a),this.handler.apply(a.currentTarget,[a]),"touchend"==a.type&&MBP.preventGhostClick(this.startX,this.startY);var c=RegExp(" ?"+this.pressedClass,"gi");b.className=b.className.replace(c,"")},MBP.fastButton.prototype.reset=function(b){var d=b.target||b.srcElement;c(d,"touchend",this,!1),c(a.body,"touchmove",this,!1);var e=RegExp(" ?"+this.pressedClass,"gi");d.className=d.className.replace(e,"")},MBP.fastButton.prototype.addClickEvent=function(a){b(a,"touchstart",this,!1),b(a,"click",this,!1)},MBP.preventGhostClick=function(a,b){MBP.coords.push(a,b),window.setTimeout(function(){MBP.coords.splice(0,2)},2500)},MBP.ghostClickHandler=function(a){if(!MBP.hadTouchEvent&&MBP.dodgyAndroid)return a.stopPropagation(),a.preventDefault(),void 0;for(var b=0,c=MBP.coords.length;c>b;b+=2){var d=MBP.coords[b],e=MBP.coords[b+1];25>Math.abs(a.clientX-d)&&25>Math.abs(a.clientY-e)&&(a.stopPropagation(),a.preventDefault())}},MBP.dodgyAndroid="ontouchstart"in window&&-1!=navigator.userAgent.indexOf("Android 2.3"),a.addEventListener&&a.addEventListener("click",MBP.ghostClickHandler,!0),b(a.documentElement,"touchstart",function(){MBP.hadTouchEvent=!0},!1),MBP.coords=[],MBP.autogrow=function(a,b){function c(){var b=this.scrollHeight,c=this.clientHeight;b>c&&(this.style.height=b+3*e+"px")}var d=b?b:12,e=a.currentStyle?a.currentStyle.lineHeight:getComputedStyle(a,null).lineHeight;e=-1==e.indexOf("px")?d:parseInt(e,10),a.style.overflow="hidden",a.addEventListener?a.addEventListener("input",c,!1):a.attachEvent("onpropertychange",c)},MBP.enableActive=function(){a.addEventListener("touchstart",function(){},!1)},MBP.preventScrolling=function(){a.addEventListener("touchmove",function(a){"range"!==a.target.type&&a.preventDefault()},!1)},MBP.preventZoom=function(){for(var b=a.querySelectorAll("input, select, textarea"),c="width=device-width,initial-scale=1,maximum-scale=",d=0,e=b.length,f=function(){MBP.viewportmeta.content=c+"1"},g=function(){MBP.viewportmeta.content=c+"10"};e>d;d++)b[d].onfocus=f,b[d].onblur=g},MBP.startupImage=function(){var b,c,d,e,f,g;d=window.devicePixelRatio,e=a.getElementsByTagName("head")[0],"iPad"===navigator.platform?(b=2===d?"img/startup/startup-tablet-portrait-retina.png":"img/startup/startup-tablet-portrait.png",c=2===d?"img/startup/startup-tablet-landscape-retina.png":"img/startup/startup-tablet-landscape.png",f=a.createElement("link"),f.setAttribute("rel","apple-touch-startup-image"),f.setAttribute("media","screen and (orientation: portrait)"),f.setAttribute("href",b),e.appendChild(f),g=a.createElement("link"),g.setAttribute("rel","apple-touch-startup-image"),g.setAttribute("media","screen and (orientation: landscape)"),g.setAttribute("href",c),e.appendChild(g)):(b=2===d?"img/startup/startup-retina.png":"img/startup/startup.png",b=568===screen.height?"img/startup/startup-retina-4in.png":b,f=a.createElement("link"),f.setAttribute("rel","apple-touch-startup-image"),f.setAttribute("href",b),e.appendChild(f)),568===screen.height&&MBP.viewportmeta&&(MBP.viewportmeta.content=MBP.viewportmeta.content.replace(/\bwidth\s*=\s*320\b/,"width=320.1").replace(/\bwidth\s*=\s*device-width\b/,""))}})(document);
