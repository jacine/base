/*!
 * FooTable - Awesome Responsive Tables
 * http://themergency.com/footable
 *
 * Requires jQuery - http://jquery.com/
 *
 * Copyright 2012 Steven Usher & Brad Vincent
 * Released under the MIT license
 * You are free to use FooTable in commercial projects as long as this copyright header is left intact.
 *
 * Date: 18 Nov 2012
 */
(function(a,b,c){function e(){var a=this;a.id=null,a.busy=!1,a.start=function(b,c){a.busy||(a.stop(),a.id=setTimeout(function(){b(),a.id=null,a.busy=!1},c),a.busy=!0)},a.stop=function(){null!=a.id&&(clearTimeout(a.id),a.id=null,a.busy=!1)}}function f(d,f,g){var h=this;h.id=g,h.table=d,h.options=f,h.breakpoints=[],h.breakpointNames="",h.columns={};var i=h.options,j=i.classes;return h.timers={resize:new e,register:function(a){return h.timers[a]=new e,h.timers[a]}},b.footable.plugins.init(h),h.init=function(){var d=a(b),e=a(h.table);if(e.hasClass(j.loaded))return h.raise("footable_already_initialized"),c;e.addClass(j.loading),e.find("> thead > tr > th, > thead > tr > td").each(function(){var a=h.getColumnData(this);h.columns[a.index]=a;var b=a.index+1,c=e.find("> tbody > tr > td:nth-child("+b+")");null!=a.className&&c.not(".footable-cell-detail").addClass(a.className)});for(var f in i.breakpoints)h.breakpoints.push({name:f,width:i.breakpoints[f]}),h.breakpointNames+=f+" ";h.breakpoints.sort(function(a,b){return a.width-b.width}),h.bindToggleSelectors(),h.raise("footable_initializing"),e.bind("footable_initialized",function(){h.resize(),e.removeClass(j.loading),e.find('[data-init="hide"]').hide(),e.find('[data-init="show"]').show(),e.addClass(j.loaded)}),d.bind("resize.footable",function(){h.timers.resize.stop(),h.timers.resize.start(function(){h.raise("footable_resizing"),h.resize(),h.raise("footable_resized")},i.delay)}),h.raise("footable_initialized")},h.bindToggleSelectors=function(){var b=a(h.table);b.find(i.toggleSelector).unbind("click.footable").bind("click.footable",function(){if(b.is(".breakpoint")){var d=a(this).is("tr")?a(this):a(this).parents("tr:first");h.toggleDetail(d.get(0))}})},h.parse=function(a,b){var c=i.parsers[b.type]||i.parsers.alpha;return c(a)},h.getColumnData=function(b){var c=a(b),d=c.data("hide");d=d||"",d=d.split(",");var e={index:c.index(),hide:{},type:c.data("type")||"alpha",name:c.data("name")||a.trim(c.text()),ignore:c.data("ignore")||!1,className:c.data("class")||null};e.hide["default"]="all"===c.data("hide")||a.inArray("default",d)>=0;for(var f in i.breakpoints)e.hide[f]="all"===c.data("hide")||a.inArray(f,d)>=0;var g=h.raise("footable_column_data",{column:{data:e,th:b}});return g.column.data},h.getViewportWidth=function(){return window.innerWidth||(document.body?document.body.offsetWidth:0)},h.getViewportHeight=function(){return window.innerHeight||(document.body?document.body.offsetHeight:0)},h.hasBreakpointColumn=function(a){for(var b in h.columns)if(h.columns[b].hide[a])return!0;return!1},h.resize=function(){var b=a(h.table),c={width:b.width(),height:b.height(),viewportWidth:h.getViewportWidth(),viewportHeight:h.getViewportHeight(),orientation:null};c.orientation=c.viewportWidth>c.viewportHeight?"landscape":"portrait",c.viewportWidth<c.width&&(c.width=c.viewportWidth),c.viewportHeight<c.height&&(c.height=c.viewportHeight);var d=b.data("footable_info");if(b.data("footable_info",c),!d||d&&d.width&&d.width!=c.width||d&&d.height&&d.height!=c.height){for(var f,e=null,g=0;h.breakpoints.length>g;g++)if(f=h.breakpoints[g],f&&f.width&&c.width<=f.width){e=f;break}var i=null==e?"default":e.name,j=h.hasBreakpointColumn(i);b.removeClass("default breakpoint").removeClass(h.breakpointNames).addClass(i+(j?" breakpoint":"")).find("> thead > tr > th").each(function(){var c=h.columns[a(this).index()],d=c.index+1,e=b.find("> tbody > tr > td:nth-child("+d+"), > tfoot > tr > td:nth-child("+d+"), > colgroup > col:nth-child("+d+")").add(this);0==c.hide[i]?e.show():e.hide()}).end().find("> tbody > tr.footable-detail-show").each(function(){h.createOrUpdateDetailRow(this)}),b.find("> tbody > tr.footable-detail-show:visible").each(function(){var b=a(this).next();b.hasClass("footable-row-detail")&&("default"!=i||j?b.show():b.hide())}),h.raise("footable_breakpoint_"+i,{info:c})}},h.toggleDetail=function(b){var c=a(b),d=h.createOrUpdateDetailRow(c.get(0)),e=c.next();!d&&e.is(":visible")?(c.removeClass("footable-detail-show"),e.hide()):(c.addClass("footable-detail-show"),e.show())},h.createOrUpdateDetailRow=function(b){var f,d=a(b),e=d.next(),g=[];if(!d.is(":hidden")){d.find("> td:hidden").each(function(){var b=h.columns[a(this).index()];return 1==b.ignore?!0:(g.push({name:b.name,value:h.parse(this,b),display:a.trim(a(this).html())}),c)});var j=d.find("> td:visible").length,k=e.hasClass("footable-row-detail");return k||(e=a('<tr class="footable-row-detail"><td class="footable-cell-detail"><div class="footable-row-detail-inner"></div></td></tr>'),d.after(e)),e.find("> td:first").attr("colspan",j),f=e.find(".footable-row-detail-inner").empty(),i.createDetail(f,g),!k}},h.raise=function(b,c){c=c||{};var d={ft:h};a.extend(!0,d,c);var e=a.Event(b,d);return e.ft||a.extend(!0,e,d),a(h.table).trigger(e),e},h.init(),h}b.footable={options:{delay:100,breakpoints:{phone:480,tablet:1024},parsers:{alpha:function(b){return a(b).data("value")||a.trim(a(b).text())}},toggleSelector:" > tbody > tr:not(.footable-row-detail)",createDetail:function(a,b){for(var c=0;b.length>c;c++)a.append("<div><strong>"+b[c].name+"</strong> : "+b[c].display+"</div>")},classes:{loading:"footable-loading",loaded:"footable-loaded",sorted:"footable-sorted",descending:"footable-sorted-desc",indicator:"footable-sort-indicator"},debug:!1},version:{major:0,minor:1,toString:function(){return b.footable.version.major+"."+b.footable.version.minor},parse:function(a){return version=/(\d+)\.?(\d+)?\.?(\d+)?/.exec(a),{major:parseInt(version[1])||0,minor:parseInt(version[2])||0,patch:parseInt(version[3])||0}}},plugins:{_validate:function(c){return"string"!=typeof c.name?(1==b.footable.options.debug&&console.error('Validation failed, plugin does not implement a string property called "name".',c),!1):a.isFunction(c.init)?(1==b.footable.options.debug&&console.log('Validation succeeded for plugin "'+c.name+'".',c),!0):(1==b.footable.options.debug&&console.error('Validation failed, plugin "'+c.name+'" does not implement a function called "init".',c),!1)},registered:[],register:function(d,e){b.footable.plugins._validate(d)&&(b.footable.plugins.registered.push(d),e!=c&&"object"==typeof e&&a.extend(!0,b.footable.options,e),1==b.footable.options.debug&&console.log('Plugin "'+d.name+'" has been registered with the Foobox.',d))},init:function(a){for(var c=0;b.footable.plugins.registered.length>c;c++)try{b.footable.plugins.registered[c].init(a)}catch(d){1==b.footable.options.debug&&console.error(d)}}}};var d=0;a.fn.footable=function(c){c=c||{};var e=a.extend(!0,{},b.footable.options,c);return this.each(function(){d++,this.footable=new f(this,e,d)})}})(jQuery,window);
